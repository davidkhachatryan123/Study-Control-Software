"use strict";(self.webpackChunkStudyControlSoftware=self.webpackChunkStudyControlSoftware||[]).push([[631],{8631:(rt,C,a)=>{a.r(C),a.d(C,{AdminsModule:()=>st});var A=a(6895),U=a(9299),r=a(4006),c=a(3546),l=a(7155),h=a(1581),p=a(6308),f=a(4859),w=a(7392),N=a(6338),u=a(9549),Z=a(4144),d=a(5412),D=a(7331),E=a(7957),x=a(1948),I=a(7943),v=a(4713),S=a(7188),t=a(4650);class _{constructor(i,e,o,s,m,g){this.id=i,this.username=e,this.password=o,this.passwordConfirm=s,this.email=m,this.phoneNumber=g}}var y=a(569);let b=(()=>{class n{constructor(e,o){this.dialogRef=e,this.data=o,this.roles=y.uJ,this.title="",this.submitBtnText="",this.onSubmit=new t.vpe,this.newUserForm=new r.cw({username:new r.NI(o.user.username,[r.kI.required,r.kI.maxLength(16),r.kI.pattern("(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$")]),password:new r.NI("",[r.kI.required,r.kI.minLength(8),r.kI.maxLength(64),r.kI.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[@$!%*?&=#])[A-Za-z0-9@$!%*?&=#]+$")]),confirmPassword:new r.NI("",[r.kI.required,r.kI.minLength(8),r.kI.maxLength(64),r.kI.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[@$!%*?&=#])[A-Za-z0-9@$!%*?&=#]+$")]),email:new r.NI(o.user.email,[r.kI.required,r.kI.email]),phoneNumber:new r.NI(o.user.phoneNumber)})}onSubmitEvent(){this.newUserForm.valid&&this.onSubmit.emit({id:this.data.user.id,user:new _(this.data.user.id,this.newUserForm.controls.username.value,this.newUserForm.controls.password.value,this.newUserForm.controls.confirmPassword.value,this.newUserForm.controls.email.value,this.newUserForm.controls.phoneNumber.value)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.so),t.Y36(d.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dashboard-admin-new"]],inputs:{title:"title",submitBtnText:"submitBtnText"},outputs:{onSubmit:"onSubmit"},decls:60,vars:6,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["novalidate","",3,"formGroup"],["userForm",""],["appearance","outline"],["type","text","matInput","","placeholder","Username","formControlName","username"],["username",""],["align","end"],["type","password","matInput","","placeholder","Password","formControlName","password"],["password",""],["type","password","matInput","","placeholder","Confirm Password","formControlName","confirmPassword"],["confirmPassword",""],["type","text","matInput","","placeholder","Email","formControlName","email"],["email",""],["type","tel","matInput","","placeholder","Phone number","formControlName","phoneNumber"],["mat-dialog-actions","","align","end"],["mat-flat-button","","mat-dialog-close","","color","warn"],["mat-flat-button","","cdkFocusInitial","","color","primary","type","button",3,"click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1)(3,"form",2,3)(5,"mat-card-content")(6,"mat-form-field",4)(7,"mat-label"),t._uU(8,"Enter Username"),t.qZA(),t._UZ(9,"input",5,6),t.TgZ(11,"mat-hint",7),t._uU(12),t.qZA(),t.TgZ(13,"mat-error"),t._uU(14,"Username is invalid"),t.qZA()(),t._UZ(15,"br")(16,"br"),t.TgZ(17,"mat-form-field",4)(18,"mat-label"),t._uU(19,"Enter Password"),t.qZA(),t._UZ(20,"input",8,9),t.TgZ(22,"mat-hint",7),t._uU(23),t.qZA(),t.TgZ(24,"mat-error"),t._uU(25,"Password is invalid"),t.qZA()(),t._UZ(26,"br")(27,"br"),t.TgZ(28,"mat-form-field",4)(29,"mat-label"),t._uU(30,"Confirm Password"),t.qZA(),t._UZ(31,"input",10,11),t.TgZ(33,"mat-hint",7),t._uU(34),t.qZA(),t.TgZ(35,"mat-error"),t._uU(36,"Passwords Mismatch"),t.qZA()(),t._UZ(37,"br")(38,"br"),t.TgZ(39,"mat-form-field",4)(40,"mat-label"),t._uU(41,"Enter Email"),t.qZA(),t._UZ(42,"input",12,13),t.TgZ(44,"mat-error"),t._uU(45,"Email is invalid"),t.qZA()(),t._UZ(46,"br")(47,"br"),t.TgZ(48,"mat-form-field",4)(49,"mat-label"),t._uU(50,"Enter Phone number"),t.qZA(),t._UZ(51,"input",14,11),t.TgZ(53,"mat-error"),t._uU(54,"Phone number is invalid"),t.qZA()()()()(),t.TgZ(55,"div",15)(56,"button",16),t._uU(57,"Cancle"),t.qZA(),t.TgZ(58,"button",17),t.NdJ("click",function(){return o.onSubmitEvent()}),t._uU(59),t.qZA()()),2&e){const s=t.MAs(10),m=t.MAs(21),g=t.MAs(32);t.xp6(1),t.Oqu(o.title),t.xp6(2),t.Q6J("formGroup",o.newUserForm),t.xp6(9),t.hij("",s.value.length,"/16"),t.xp6(11),t.hij("",m.value.length,"/64"),t.xp6(11),t.hij("",g.value.length,"/64"),t.xp6(25),t.Oqu(o.submitBtnText)}},dependencies:[r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,c.dn,f.lW,u.KE,u.hX,u.bx,u.TO,Z.Nt,d.ZT,d.uh,d.xY,d.H8],encapsulation:2}),n})();var Y=a(7009),L=a(1162),k=a(529);let T=(()=>{class n extends L.C{constructor(e){super(e,"manageAdmins")}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(k.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var B=a(3252),O=a(2633),F=a(6969),J=a(1702);function R(n,i){1&n&&(t.TgZ(0,"th",14),t._uU(1," No. "),t.qZA())}function Q(n,i){if(1&n&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",e.id," ")}}function M(n,i){1&n&&(t.TgZ(0,"th",14),t._uU(1," Username "),t.qZA())}function P(n,i){if(1&n&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",e.username," ")}}function $(n,i){1&n&&(t.TgZ(0,"th",14),t._uU(1," Email "),t.qZA())}function q(n,i){if(1&n&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",e.email," ")}}function z(n,i){1&n&&(t.TgZ(0,"th",14),t._uU(1," Email Confirmed "),t.qZA())}function G(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"true"),t.qZA())}function j(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,m=t.oxw();return t.KtG(m.onConfirmEmailEvent(s.email))}),t._uU(1," Send Confirm Email "),t.qZA()}}function H(n,i){if(1&n&&(t.TgZ(0,"td",15),t.YNc(1,G,2,0,"span",16),t.YNc(2,j,2,0,"button",17),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.Q6J("ngIf",e.emailConfirmed),t.xp6(1),t.Q6J("ngIf",!e.emailConfirmed)}}function X(n,i){1&n&&(t.TgZ(0,"th",14),t._uU(1," Phone Number "),t.qZA())}function W(n,i){if(1&n&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",e.phoneNumber," ")}}function K(n,i){1&n&&(t.TgZ(0,"th",19),t._uU(1," Actions "),t.qZA())}function V(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",21)(1,"button",22),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,m=t.oxw();return t.KtG(m.onEditEvent(s))}),t._uU(2," Edit "),t.qZA(),t.TgZ(3,"button",23),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,m=t.oxw();return t.KtG(m.onDeleteEvent(s.id,s.username))}),t._uU(4,"Delete"),t.qZA()()}}function tt(n,i){if(1&n&&(t.TgZ(0,"td",15),t.YNc(1,V,5,0,"div",20),t.qZA()),2&n){const e=i.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",e.username!=o.appUser.userName)}}function et(n,i){1&n&&t._UZ(0,"tr",24)}function nt(n,i){1&n&&t._UZ(0,"tr",25)}const ot=function(){return[5,10,20]};let it=(()=>{class n{constructor(e){this.storageService=e,this.displayedColumns=["username","email","emailConfirmed","phoneNumber","actions"],this.data=[],this.resultsLength=0,this.onChange=new t.vpe,this.onDelete=new t.vpe,this.onEdit=new t.vpe,this.onConfirmEmail=new t.vpe,this.userListOptions=new v.j("","",0,0)}ngOnInit(){this.appUser=this.storageService.getUser()}ngAfterViewInit(){this.onChangeEvent(),this.sort.sortChange.subscribe(()=>{this.paginator.pageIndex=0,this.onChangeEvent()}),this.paginator.page.subscribe(()=>{this.onChangeEvent()})}onChangeEvent(){this.userListOptions.sort=this.sort.active,this.userListOptions.sortDirection=this.sort.direction,this.userListOptions.pageIndex=this.paginator.pageIndex,this.userListOptions.pageSize=this.paginator.pageSize,this.onChange.emit(this.userListOptions)}onDeleteEvent(e,o){this.onDelete.emit({id:e,username:o})}onEditEvent(e){this.onEdit.emit(e)}onConfirmEmailEvent(e){this.onConfirmEmail.emit(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(J.V))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dashboard-admins-card"]],viewQuery:function(e,o){if(1&e&&(t.Gf(l.BZ,5),t.Gf(p.YE,5),t.Gf(h.NW,5)),2&e){let s;t.iGM(s=t.CRH())&&(o.table=s.first),t.iGM(s=t.CRH())&&(o.sort=s.first),t.iGM(s=t.CRH())&&(o.paginator=s.first)}},inputs:{data:"data",resultsLength:"resultsLength"},outputs:{onChange:"onChange",onDelete:"onDelete",onEdit:"onEdit",onConfirmEmail:"onConfirmEmail"},decls:27,vars:6,consts:[[1,"card"],["mat-table","","matSort","","matSortActive","username","matSortDirection","asc","matSortDisableClear","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","email"],["matColumnDef","emailConfirmed"],["matColumnDef","phoneNumber"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"length","pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[4,"ngIf"],["mat-flat-button","","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","accent",3,"click"],["mat-header-cell",""],["class","actions-wrapper",4,"ngIf"],[1,"actions-wrapper"],["mat-flat-button","","color","accent",1,"action-btn",3,"click"],["mat-flat-button","","color","warn",1,"action-btn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3," Admins "),t.qZA()(),t.TgZ(4,"mat-card-content")(5,"table",1),t.ynx(6,2),t.YNc(7,R,2,0,"th",3),t.YNc(8,Q,2,1,"td",4),t.BQk(),t.ynx(9,5),t.YNc(10,M,2,0,"th",3),t.YNc(11,P,2,1,"td",4),t.BQk(),t.ynx(12,6),t.YNc(13,$,2,0,"th",3),t.YNc(14,q,2,1,"td",4),t.BQk(),t.ynx(15,7),t.YNc(16,z,2,0,"th",3),t.YNc(17,H,3,2,"td",4),t.BQk(),t.ynx(18,8),t.YNc(19,X,2,0,"th",3),t.YNc(20,W,2,1,"td",4),t.BQk(),t.ynx(21,9),t.YNc(22,K,2,0,"th",10),t.YNc(23,tt,2,1,"td",4),t.BQk(),t.YNc(24,et,1,0,"tr",11),t.YNc(25,nt,1,0,"tr",12),t.qZA(),t._UZ(26,"mat-paginator",13),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("dataSource",o.data),t.xp6(19),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("length",o.resultsLength)("pageSizeOptions",t.DdM(5,ot)))},dependencies:[A.O5,c.a8,c.dn,c.dk,c.n5,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,h.NW,p.YE,p.nU,f.lW],encapsulation:2}),n})();const at=[{path:"",component:(()=>{class n{constructor(e,o,s,m){this.dialog=e,this._snackBar=o,this.adminsService=s,this.authService=m,this.data=[],this.resultsLength=0}onChangeUserCard(e){this.userListOptions=e,this.getUsers()}getUsers(){this.adminsService.getAll(new v.j(this.userListOptions.sort,this.userListOptions.sortDirection,this.userListOptions.pageIndex,this.userListOptions.pageSize)).subscribe(e=>{this.data=e.entities,this.resultsLength=e.totalCount})}onNew(){this.openNewDialog()}openNewDialog(){this.createDialogRef=this.dialog.open(b,{width:"500px",data:{user:new _("","","","","","")}}),this.createDialogRef.componentInstance.title="Create new Admin",this.createDialogRef.componentInstance.submitBtnText="Create",this.createDialogRef.componentInstance.onSubmit.subscribe(e=>{this.new(e)})}new(e){this.adminsService.create(e.user).subscribe({next:o=>{this._snackBar.open("User created successful!","Ok",{duration:1e4}),this.createDialogRef.close(),this.getUsers()},error:o=>{this._snackBar.open("Validating error!","Ok",{duration:1e4})}})}onDelete(e){this.openDeleteDialog(e.id,e.username)}openDeleteDialog(e,o){this.dialog.open(S.F,{width:"250px",data:{value:o,isDelete:"false"}}).afterClosed().subscribe(m=>{m&&this.delete(e)})}delete(e){this.adminsService.delete(e).subscribe(()=>{this._snackBar.open("User deleted!","Ok",{duration:1e4}),this.getUsers()})}onEdit(e){this.openEditDialog(e)}openEditDialog(e){this.createDialogRef=this.dialog.open(b,{width:"500px",data:{user:e}}),this.createDialogRef.componentInstance.title="Edit User",this.createDialogRef.componentInstance.submitBtnText="Edit",this.createDialogRef.componentInstance.onSubmit.subscribe(o=>{this.edit(o.id,o.user)})}edit(e,o){this.adminsService.edit(e,o).subscribe(s=>{this._snackBar.open(s.username+" user changed!","Ok",{duration:1e4}),this.createDialogRef.close(),this.getUsers()})}onConfirmEmail(e){this.authService.sendConfirmEmail(e).subscribe(o=>{this._snackBar.open("Message sended!","Ok",{duration:1e4})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.uw),t.Y36(Y.ux),t.Y36(T),t.Y36(B.e))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dashboard-admins"]],decls:3,vars:2,consts:[[3,"onNew"],[3,"data","resultsLength","onChange","onDelete","onEdit","onConfirmEmail"]],template:function(e,o){1&e&&(t.TgZ(0,"app-dashboard-layout")(1,"app-dashboard-actions-new",0),t.NdJ("onNew",function(){return o.onNew()}),t.qZA(),t.TgZ(2,"app-dashboard-admins-card",1),t.NdJ("onChange",function(m){return o.onChangeUserCard(m)})("onDelete",function(m){return o.onDelete(m)})("onEdit",function(m){return o.onEdit(m)})("onConfirmEmail",function(m){return o.onConfirmEmail(m)}),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("data",o.data)("resultsLength",o.resultsLength))},dependencies:[O.n,F.h,it],encapsulation:2}),n})()}];let st=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[T],imports:[I.m,U.Bz.forChild(at),r.u5,r.UX,A.ez,c.QW,l.p0,h.TU,p.JX,f.ot,w.Ps,N.ie,u.lN,Z.c,d.Is,D.Hi,E.Bb,x.Fk]}),n})()}}]);